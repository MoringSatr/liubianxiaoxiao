{"version":3,"sources":["../../../../../assets/script/gameCore/assets/script/gameCore/InitLBXFrame.js"],"names":["disList","Util","require","theScore","cc","Class","extends","Component","properties","default","type","SpriteFrame","url","AudioClip","Prefab","checkXC","argument","testCode1","addScore","curFKLen","tipNode","instantiate","tipPrefab","color","label","getComponent","Label","string","getAddScoreCal","node","addChild","haveFKIndexList","i","frameList","length","isHaveFK","push","FKIndex","sort","a","b","xcList","oneXCList","intersectAry","get2AryIntersect","isXC","check2AryIsEqual","log","audioEngine","playEffect","xiaochuSound","actionAry","self","count","oneList","j","xIndex","callFunc","arguments","effNode","boomEffPrefab","FKNode","getChildByName","cascadeOpacity","runAction","sequence","spawn","scaleTo","fadeOut","removeSelf","delayTime","isDeleting","checkIsLose","action","testCode2","find","script","opacity","shuNode","shuPrefab","parent","oldScore","sys","localStorage","getItem","setItem","XCCount","isDropAdd","addScoreCount","Number","x","ary1","ary2","onLoad","srcPos","p","y","lbxNodes","lbxNodesIndex","maxCount","posList","addVec","pMult","pForAngle","Math","PI","pianyiTo0p0Vec","fPosList","oneSrcPos","pAdd","aimPos","fPos","index","Node","sprite","addComponent","Sprite","spriteFrame","picNode","spr","active","on"],"mappings":"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","file":"InitLBXFrame.js","sourceRoot":"../../../../../assets/script/gameCore","sourcesContent":["const disList = [\r\n    //一个方向\r\n    [0, 1, 2, 3, 4],\r\n    [5, 6, 7, 8, 9, 10],\r\n    [11, 12, 13, 14, 15, 16, 17],\r\n    [18, 19, 20, 21, 22, 23, 24, 25],\r\n    [26, 27, 28, 29, 30, 31, 32, 33, 34],\r\n    [35, 36, 37, 38, 39, 40, 41, 42],\r\n    [43, 44, 45, 46, 47, 48, 49],\r\n    [50, 51, 52, 53, 54, 55],\r\n    [56, 57, 58, 59, 60],\r\n\r\n    //另一个方向\r\n    [26, 35, 43, 50, 56],\r\n    [18, 27, 36, 44, 51, 57],\r\n    [11, 19, 28, 37, 45, 52, 58],\r\n    [5, 12, 20, 29, 38, 46, 53, 59],\r\n    [0, 6, 13, 21, 30, 39, 47, 54, 60],\r\n    [1, 7, 14, 22, 31, 40, 48, 55],\r\n    [2, 8, 15, 23, 32, 41, 49],\r\n    [3, 9, 16, 24, 33, 42],\r\n    [4, 10, 17, 25, 34],\r\n\r\n    //横向\r\n    [0, 5, 11, 18, 26],\r\n    [1, 6, 12, 19, 27, 35],\r\n    [2, 7, 13, 20, 28, 36, 43],\r\n    [3, 8, 14, 21, 29, 37, 44, 50],\r\n    [4, 9, 15, 22, 30, 38, 45, 51, 56],\r\n    [10, 16, 23, 31, 39, 46, 52, 57],\r\n    [17, 24, 32, 40, 47, 53, 58],\r\n    [25, 33, 41, 48, 54, 59],\r\n    [34, 42, 49, 55, 60],\r\n]\r\n\r\nconst Util = require('Util')\r\nvar theScore = 0\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        [\"bianchanggezishu\"]: 5,\r\n        [\"liubianxingH\"]: 0,\r\n        [\"liubianxingA\"]: 0,\r\n        [\"framePic\"]:{\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"bian\"]:{\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n\r\n        xiaochuSound:{\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n\r\n        shuPrefab:{\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        boomEffPrefab:{\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        tipPrefab:{\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n    },\r\n\r\n\r\n\r\n    /**\r\n     * 消除检测\r\n     * @param  {[type]}\r\n     * @return {[type]}\r\n     */\r\n    checkXC: function(argument) {\r\n        Util.testCode1('消除逻辑')\r\n\r\n        //放下都加分\r\n        this.addScore(this.curFKLen, true)\r\n        //加分飘字\r\n        var tipNode = cc.instantiate(this.tipPrefab)\r\n        tipNode.color = cc.color(211, 70, 50, 255)\r\n        var label = tipNode.getComponent(cc.Label)\r\n        label.string = \"+\" + this.getAddScoreCal(this.curFKLen, true)\r\n        this.node.addChild(tipNode)\r\n\r\n        var haveFKIndexList = []\r\n        for (var i = 0; i < this.frameList.length; i++) {\r\n            if(this.frameList[i].isHaveFK){\r\n                //cc.log(this.frameList[i].FKIndex)\r\n                haveFKIndexList.push(this.frameList[i].FKIndex)\r\n            }\r\n            \r\n        }\r\n\r\n        haveFKIndexList.sort(function(a, b){return a - b})\r\n\r\n        //cc.log(\"haveFKIndexList：\", haveFKIndexList.toString())\r\n\r\n        var xcList = []//要消除的方块列表\r\n        for (var i = 0; i < disList.length; i++) {\r\n            var oneXCList = disList[i]\r\n            var intersectAry = this.get2AryIntersect(haveFKIndexList, oneXCList)\r\n\r\n\r\n            if(intersectAry.length > 0){\r\n                //cc.log(\"intersectAry:\", intersectAry.toString())\r\n                //cc.log(\"oneXCList:\", oneXCList.toString())\r\n\r\n                var isXC = this.check2AryIsEqual(oneXCList, intersectAry)\r\n\r\n                //cc.log(\"intersectAry 和 oneXCList是否相等：\", isXC)\r\n                if(isXC){\r\n                    cc.log(\"消！！\")\r\n                    xcList.push(oneXCList)\r\n\r\n                    cc.audioEngine.playEffect(this.xiaochuSound)\r\n                }\r\n            }\r\n        }\r\n\r\n        //cc.log(\"消除表现！！\")\r\n        \r\n        var actionAry = []\r\n        var self = this\r\n        //消除\r\n        var count = 0\r\n        for (var i = 0; i < xcList.length; i++) {\r\n\r\n            var oneList = xcList[i]\r\n            for (var j = 0; j < oneList.length; j++) {\r\n                var xIndex = oneList[j]\r\n\r\n                actionAry.push(cc.callFunc(function(){\r\n                    var xIndex = arguments[1][0]\r\n                    var count = arguments[1][1]\r\n                    var effNode = cc.instantiate(this.boomEffPrefab)\r\n                    this.frameList[xIndex].addChild(effNode)\r\n\r\n                    //加分飘字\r\n                    var tipNode = cc.instantiate(this.tipPrefab)\r\n                    var label = tipNode.getComponent(cc.Label)\r\n                    label.string = \"+\" + this.getAddScoreCal(count)\r\n                    this.frameList[xIndex].addChild(tipNode)\r\n                }, this, [xIndex, count]))\r\n\r\n\r\n                actionAry.push(cc.callFunc(function(){\r\n                    var xIndex = arguments[1]\r\n                    this.frameList[xIndex].isHaveFK = null\r\n\r\n                    var FKNode = this.frameList[xIndex].getChildByName(\"colorSpr\")\r\n                    if (!FKNode) {\r\n                        return//防止没有这个方块的时候\r\n                    }\r\n                    //FKNode.removeFromParent()\r\n\r\n                    FKNode.cascadeOpacity = true\r\n                    //这个假方块变大并且渐隐掉\r\n                    FKNode.runAction(cc.sequence(\r\n                        cc.spawn(cc.scaleTo(0.5, 2), cc.fadeOut(0.5)),\r\n                        cc.removeSelf(true)\r\n                    ))\r\n                    \r\n                }, this, xIndex))\r\n\r\n                actionAry.push(cc.delayTime(0.1))\r\n\r\n                count++\r\n            }\r\n            \r\n        }\r\n\r\n        if (actionAry.length > 0) {\r\n            actionAry.push(cc.callFunc(function(){\r\n                this.isDeleting = false\r\n                this.checkIsLose()\r\n            }, this))\r\n\r\n            this.isDeleting = true\r\n            var action = cc.sequence(actionAry)\r\n            this.node.runAction(action)\r\n\r\n            //加分\r\n            this.addScore(count)\r\n        }\r\n        \r\n\r\n\r\n        Util.testCode2('消除逻辑')\r\n\r\n        \r\n    },\r\n\r\n    //检测是不是输了\r\n    checkIsLose: function() {\r\n        //如果正在消除中，那就不判断输赢，因为消除后会再判断\r\n        if (this.isDeleting) return\r\n\r\n        var count = 0\r\n        for (var i = 0; i < 3; i++) {\r\n            var node = cc.find('Canvas/getNewFK' + (i + 1))\r\n            var script = node.getComponent('NewLBXKuai')\r\n            if(script.checkIsLose()){\r\n                \r\n                //cc.log(\"方块\" + (i + 1) + \"已经无处安放\")\r\n                count++\r\n                node.opacity = 125\r\n            }\r\n            else{\r\n\r\n                //cc.log(\"方块\" + (i + 1) + \"可以安放\")\r\n                node.opacity = 255\r\n            }\r\n            \r\n        }\r\n\r\n        if (count == 3) {\r\n            var shuNode = cc.instantiate(this.shuPrefab)\r\n            this.node.parent.addChild(shuNode)\r\n\r\n            cc.log(\"保存历史最高分\")\r\n            var oldScore = cc.sys.localStorage.getItem(\"score\")\r\n            if (oldScore < theScore) {\r\n                cc.sys.localStorage.setItem(\"score\", theScore)\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    //加分，参数是消除的总数,isDropAdd是是否是放下的单纯加分\r\n    addScore: function(XCCount, isDropAdd) {\r\n        var addScoreCount = this.getAddScoreCal(XCCount, isDropAdd)\r\n        var node = cc.find('Canvas/score/scoreLabel')\r\n        var label = node.getComponent(cc.Label)\r\n\r\n        label.string = addScoreCount + Number(label.string)\r\n        theScore = Number(label.string)\r\n    },\r\n\r\n    //计算加分的公式\r\n    getAddScoreCal: function(XCCount, isDropAdd) {\r\n        var x = XCCount + 1\r\n        var addScoreCount = isDropAdd ? x : 2 * x * x//数量的平方\r\n        return addScoreCount\r\n    },\r\n\r\n\r\n\r\n    //获得两个数组的交集\r\n    get2AryIntersect: function(ary1, ary2) {\r\n        var intersectAry = []\r\n        for (var i = 0; i < ary1.length; i++) {\r\n            for (var j = 0; j < ary2.length; j++) {\r\n                if(ary2[j] == ary1[i]){\r\n                    intersectAry.push(ary2[j])\r\n                }\r\n            }\r\n        }\r\n\r\n        return intersectAry\r\n    },\r\n\r\n\r\n    /**\r\n     * 获得两个数组的交集\r\n     * @param  {array}数组1\r\n     * @param  {array}数组2\r\n     * @return {boolean}是否相交\r\n     */\r\n    check2AryIsEqual: function(ary1, ary2) {\r\n        for (var i = 0; i < ary1.length; i++) {\r\n            if(ary2[i] != ary1[i]){\r\n                return false\r\n            }\r\n        }\r\n\r\n        return true\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n        var srcPos = cc.p(this.node.x, this.node.y)\r\n        var lbxNodes = []\r\n        var lbxNodesIndex = 0\r\n        var maxCount = this[\"bianchanggezishu\"] * 2 - 1\r\n\r\n        \r\n        //位置表\r\n        var posList = [\r\n            //第一行的位置信息\r\n            {\r\n                count: 5, \r\n                srcPos: cc.p(0, 0)\r\n            },\r\n            \r\n            //第二行的位置信息\r\n            {\r\n                count: 6, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"], 0)\r\n            },\r\n            \r\n            //第三行的位置信息\r\n            {\r\n                count: 7, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"] * 2, 0)\r\n            },\r\n            \r\n            //第四行的位置信息\r\n            {\r\n                count: 8, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"] * 3, 0)\r\n            },\r\n            \r\n            //第五行的位置信息\r\n            {\r\n                count: 9, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"] * 4, 0)\r\n            },\r\n            \r\n            //第六行的位置信息\r\n            {\r\n                count: 8, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"] * 4 + this[\"liubianxingH\"], (-3 * this[\"liubianxingA\"]) / 2)\r\n            },\r\n            \r\n            //第七行的位置信息\r\n            {\r\n                count: 7, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"] * 4 + this[\"liubianxingH\"] * 2, (-3 * this[\"liubianxingA\"] * 2) / 2)\r\n            },\r\n            \r\n            //第八行的位置信息\r\n            {\r\n                count: 6, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"] * 4 + this[\"liubianxingH\"] * 3, (-3 * this[\"liubianxingA\"] * 3) / 2)\r\n            },\r\n            \r\n            //第九行的位置信息\r\n            {\r\n                count: 5, \r\n                srcPos: cc.p(2 * this[\"liubianxingH\"] * 4 + this[\"liubianxingH\"] * 4, (-3 * this[\"liubianxingA\"] * 4) / 2)\r\n            },\r\n            \r\n        ]\r\n        \r\n        //要加的单位向量\r\n        var addVec = cc.pMult(cc.pForAngle(240 * (2 * Math.PI / 360)), this[\"liubianxingH\"] * 2)\r\n        \r\n        //偏移至源点0，0的向量\r\n        var pianyiTo0p0Vec = cc.pMult(cc.pForAngle(120 * (2 * Math.PI / 360)), this[\"liubianxingH\"] * 2 * 4)\r\n        \r\n        \r\n        var frameList = []\r\n        \r\n        var fPosList = []\r\n         //一列列来生成\r\n        for (var i = 0; i < posList.length; i++) {\r\n            var count = posList[i].count//数量\r\n            var oneSrcPos = cc.pAdd(posList[i].srcPos, pianyiTo0p0Vec)//起始位置\r\n            var aimPos = cc.pAdd(srcPos, oneSrcPos)//一条的起始位置\r\n\r\n            for (var j = 0; j < count; j++) {\r\n                var fPos = cc.pAdd(aimPos, cc.pMult(addVec, j))\r\n                fPosList.push(fPos)\r\n            }\r\n        }\r\n        \r\n        \r\n        //初始化\r\n        for(var index = 0; index < fPosList.length; index++){\r\n            var node = new cc.Node(\"frame\")\r\n            var sprite = node.addComponent(cc.Sprite)\r\n            sprite.spriteFrame = this[\"framePic\"]\r\n\r\n            node.x = fPosList[index].x\r\n            node.y = fPosList[index].y\r\n            \r\n            \r\n            //debug字用\r\n            // var labelNode = new cc.Node(\"New Label\")\r\n            // var labelCp = node.addComponent(cc.Label)\r\n            // labelCp.string = index//\"x:\"+Math.floor(node.x) + \"\\ny:\" + Math.floor(node.y)\r\n            // labelCp.overflow = cc.Label.Overflow.RESIZE_HEIGHT\r\n            // labelCp.fontSize = 18\r\n            // labelNode.parent = node\r\n\r\n            \r\n            node.parent = this.node\r\n            \r\n            node.FKIndex = index\r\n\r\n            //加边\r\n            var picNode = new cc.Node(\"bianSpr\")\r\n            var spr = picNode.addComponent(cc.Sprite)\r\n            spr.spriteFrame = this[\"bian\"]\r\n            picNode.active = false\r\n            picNode.parent = node\r\n\r\n            frameList.push(node)\r\n        }\r\n        \r\n        \r\n        this.frameList = frameList\r\n        this.posList = posList\r\n        this.isDeleting = false//判断是否正在消除的依据\r\n\r\n        //监听成功放下事件\r\n        this.node.on('succDropDownOne', this.checkXC, this)\r\n\r\n        //初始化历史最高分\r\n        var node = cc.find('Canvas/highScore/scoreLabel')\r\n        var label = node.getComponent(cc.Label)\r\n        label.string = cc.sys.localStorage.getItem(\"score\") || 0\r\n\r\n\r\n\r\n        //cc.log(cc.myAssets)\r\n\r\n    },\r\n\r\n\r\n});\r\n"]}