{"version":3,"sources":["../../../../../assets/script/gameCore/assets/script/gameCore/NewLBXKuai.js"],"names":["InitLBXFrame","require","Util","scaleParam","cc","Class","extends","Component","properties","checkerboard","default","type","SpriteFrame","url","AudioClip","getTheConfig","a","h","configLists","p","newOneK","colorIndex","node","Node","sprite","addComponent","Sprite","spriteFrame","wenliNode","wenliSprite","parent","newOneNode","kuaiNode","config","randomIndex","random","length","posList","sumX","countX","sumY","countY","index","pos","kuai","x","y","addChild","setScale","addTouchEvent","upH","self","ox","oy","on","EventType","TOUCH_START","getChildByName","audioEngine","playEffect","anSound","TOUCH_MOVE","event","delta","touch","getDelta","collisionFunc","checkIsCanDrop","changeColorDeal","TOUCH_CANCEL","dropDownFunc","TOUCH_END","isJustClearColor","i","frameList","guangPicNode","active","checkFrameList","checkFKlist","children","pianyiCPos","pAdd","childPos","position","frame","checkPosFunc","push","len","frameNode","dis","pDistance","checkIsLose","canDropCount","srcPos","count","isHaveFK","j","k","tFrameNode","takeBack","canNotSound1","removeAllChildren","oneNode","curFKLen","emit","ranC","onLoad","cascadeOpacity"],"mappings":"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","file":"NewLBXKuai.js","sourceRoot":"../../../../../assets/script/gameCore","sourcesContent":["const InitLBXFrame = require('InitLBXFrame')\r\nconst Util = require('Util')\r\nconst scaleParam = 0.7\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        checkerboard: {\r\n            default: null,\r\n            type: InitLBXFrame\r\n        },\r\n\r\n        [\"Kcount\"]: 3,\r\n        [\"liubianxingH\"]: 0,\r\n        [\"liubianxingA\"]: 0,\r\n        [\"kuaiTex\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color1\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color2\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color3\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color4\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n\r\n        anSound: {\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n\r\n        fangxiaSound1: {\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n\r\n        fangxiaSound2: {\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n\r\n        fangxiaSound3: {\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n\r\n        canNotSound1: {\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n\r\n        canNotSound2: {\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n\r\n    },\r\n\r\n\r\n\r\n    getTheConfig: function() {\r\n\r\n        var a = this[\"liubianxingA\"]\r\n        var h = this[\"liubianxingH\"]\r\n\r\n        var configLists = [\r\n            //一个\r\n            [cc.p(0, 0)],\r\n            //两个\r\n            [cc.p(0, 0), cc.p(h * 2, 0)], //横摆\r\n            [cc.p(0, 0), cc.p(h, a * 1.5)], //斜摆1\r\n            [cc.p(0, 0), cc.p(h, -a * 1.5)], //斜摆2\r\n            //三个\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 4, 0)], //横摆\r\n\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, a * 1.5)], //横摆1\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, -a * 1.5)], //横摆2\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h, a * 1.5)], //堆1\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h, -a * 1.5)], //堆2\r\n\r\n            [cc.p(0, 0), cc.p(h, a * 1.5), cc.p(h * 3, a * 1.5)], //斜摆1\r\n            [cc.p(0, 0), cc.p(h, a * 1.5), cc.p(h * 2, a * 3)], //斜摆2\r\n            [cc.p(0, 0), cc.p(h, a * 1.5), cc.p(0, a * 3)], //斜摆3\r\n\r\n            [cc.p(0, 0), cc.p(h, -a * 1.5), cc.p(h * 3, -a * 1.5)], //斜下摆1\r\n            [cc.p(0, 0), cc.p(h, -a * 1.5), cc.p(h * 2, -a * 3)], //斜下摆2\r\n            [cc.p(0, 0), cc.p(h, -a * 1.5), cc.p(0, -a * 3)], //斜下摆3\r\n            //四个\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 4, 0), cc.p(h * 6, 0)], //横摆1\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 4, 0), cc.p(h * 5, a * 1.5)], //横摆2\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 4, 0), cc.p(h * 5, -a * 1.5)], //横摆3\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 4, 0), cc.p(h * 3, a * 1.5)], //横摆4\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 4, 0), cc.p(h * 3, -a * 1.5)], //横摆5\r\n\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, a * 1.5), cc.p(h, a * 1.5)], //斜上摆1\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, a * 1.5), cc.p(h * 2, a * 3)], //斜上摆2\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, a * 1.5), cc.p(h * 4, a * 3)], //斜上摆3\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, a * 1.5), cc.p(h * 5, a * 1.5)], //斜上摆4\r\n\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, -a * 1.5), cc.p(h, -a * 1.5)], //斜下摆1\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, -a * 1.5), cc.p(h * 2, -a * 3)], //斜下摆2\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, -a * 1.5), cc.p(h * 4, -a * 3)], //斜下摆3\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h * 3, -a * 1.5), cc.p(h * 5, -a * 1.5)], //斜下摆4\r\n\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h, -a * 1.5), cc.p(-h, -a * 1.5)], //下堆1\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h, -a * 1.5), cc.p(0, -a * 3)], //下堆2\r\n            [cc.p(0, 0), cc.p(h * 2, 0), cc.p(h, -a * 1.5), cc.p(h * 2, -a * 3)], //下堆3\r\n\r\n            [cc.p(0, 0), cc.p(h, -a * 1.5), cc.p(h * 2, -a * 3), cc.p(h * 3, -a * 4.5)], //斜扛1\r\n            [cc.p(0, 0), cc.p(-h, -a * 1.5), cc.p(-h * 2, -a * 3), cc.p(-h * 3, -a * 4.5)], //斜扛2\r\n\r\n        ]\r\n\r\n        return configLists\r\n    },\r\n\r\n    newOneK: function(colorIndex) {\r\n        //创建一个块\r\n        var node = new cc.Node(\"colorSpr\")\r\n        var sprite = node.addComponent(cc.Sprite)\r\n        sprite.spriteFrame = this[\"color\" + colorIndex]\r\n\r\n        //cc.log(\"第\",colorIndex,\"个颜color\")\r\n\r\n        //加纹理\r\n        var wenliNode = new cc.Node(\"wenliSpr\")\r\n        var wenliSprite = wenliNode.addComponent(cc.Sprite)\r\n        wenliSprite.spriteFrame = this[\"kuaiTex\"]\r\n\r\n        wenliNode.parent = node\r\n\r\n        return node\r\n    },\r\n\r\n    newOneNode: function() {\r\n        var kuaiNode = new cc.Node(\"kuai\")\r\n\r\n\r\n        var config = this.getTheConfig()\r\n\r\n        //随机样子\r\n        var randomIndex = Util.random(0, config.length - 1)\r\n        var posList = config[randomIndex]\r\n\r\n\r\n        var randomIndex = Util.random(1, 4)\r\n        var sumX = 0\r\n        var countX = 0\r\n        var sumY = 0\r\n        var countY = 0\r\n        for (var index = 0; index < posList.length; index++) {\r\n            var pos = posList[index]\r\n            var kuai = this.newOneK(randomIndex)\r\n            kuai.x = pos.x\r\n\r\n            sumX += kuai.x\r\n            countX++\r\n\r\n            kuai.y = pos.y\r\n\r\n            sumY += kuai.y\r\n            countY++\r\n\r\n            kuaiNode.addChild(kuai)\r\n        }\r\n\r\n        kuaiNode.x = -sumX / countX\r\n        kuaiNode.y = -sumY / countY\r\n\r\n        kuaiNode.setScale(scaleParam)\r\n\r\n        return kuaiNode\r\n    },\r\n\r\n    //添加触摸\r\n    addTouchEvent: function() {\r\n        var upH = 100\r\n        var self = this\r\n\r\n        this.node.ox = this.node.x\r\n        this.node.oy = this.node.y\r\n\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START, function() {\r\n            this.y += upH\r\n                //cc.log(\"原位置：\", this.ox, this.oy)\r\n\r\n            this.getChildByName(\"kuai\").setScale(1)\r\n\r\n            cc.audioEngine.playEffect(self.anSound)\r\n\r\n        }, this.node)\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, function(event) {\r\n\r\n            var delta = event.touch.getDelta()\r\n            this.x += delta.x\r\n            this.y += delta.y\r\n\r\n            self.collisionFunc()\r\n\r\n            //变色处理\r\n            if (!self.checkIsCanDrop()) {\r\n                self.changeColorDeal(true)\r\n            } else {\r\n                self.changeColorDeal()\r\n            }\r\n        }, this.node)\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, function(event) {\r\n            this.dropDownFunc()\r\n\r\n        }, this)\r\n        this.node.on(cc.Node.EventType.TOUCH_END, function(event) {\r\n            this.dropDownFunc()\r\n\r\n        }, this)\r\n\r\n    },\r\n\r\n    //变色处理\r\n    changeColorDeal: function(isJustClearColor) {\r\n        //cc.log(\"变色！\"+isJustClearColor, this.checkFrameList.length, \"this.checkerboard.frameList.length:\", this.checkerboard.frameList.length)\r\n\r\n        for (var i = 0; i < this.checkerboard.frameList.length; i++) {\r\n\r\n            var guangPicNode = this.checkerboard.frameList[i].getChildByName(\"bianSpr\")\r\n            guangPicNode.active = false\r\n\r\n        }\r\n\r\n        //如果参数有值，直接返回，不做下面的\r\n        if (isJustClearColor) {\r\n            return\r\n        }\r\n\r\n        for (var i = 0; i < this.checkFrameList.length; i++) {\r\n\r\n            var guangPicNode = this.checkFrameList[i].getChildByName(\"bianSpr\")\r\n            guangPicNode.active = true\r\n\r\n        }\r\n\r\n    },\r\n\r\n\r\n    //碰撞逻辑\r\n    collisionFunc: function() {\r\n        //debug字用\r\n        // this.debugLabel.string = \"x:\"+Math.floor(this.node.x) + \"\\ny:\" + Math.floor(this.node.y)\r\n        //cc.log(\"x:\", this.node.x, \"y:\", this.node.y, this.node)\r\n\r\n        this.checkFrameList = [] //清空数组\r\n        this.checkFKlist = [] //清空数组\r\n\r\n        var children = this.node.children[0].children\r\n\r\n        for (var i = 0; i < children.length; i++) {\r\n\r\n            var pianyiCPos = cc.pAdd(cc.p(this.node.children[0].x, this.node.children[0].y), cc.p(children[i].x, children[i].y))\r\n            var childPos = cc.pAdd(this.node.position, pianyiCPos)\r\n            var frame = this.checkPosFunc(childPos)\r\n\r\n            if (frame) {\r\n                this.checkFKlist.push(children[i])\r\n                this.checkFrameList.push(frame)\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n\r\n    //一个点和棋盘的所有框检测\r\n    checkPosFunc: function(pos) {\r\n        var len = 27 //碰撞距离\r\n\r\n        for (var i = 0; i < this.checkerboard.frameList.length; i++) {\r\n            var frameNode = this.checkerboard.frameList[i]\r\n            var dis = cc.pDistance(cc.p(frameNode.x, frameNode.y), pos)\r\n            if (dis <= len) {\r\n                return frameNode\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    //检测自身是否已经无处可放\r\n    checkIsLose: function() {\r\n        var canDropCount = 0\r\n\r\n\r\n        var children = this.node.children[0].children\r\n\r\n        //一个个格子放试一下能不能放\r\n        for (var i = 0; i < this.checkerboard.frameList.length; i++) {\r\n            var frameNode = this.checkerboard.frameList[i]\r\n            var srcPos = cc.p(frameNode.x, frameNode.y)\r\n\r\n\r\n\r\n            var count = 1\r\n            if (!frameNode.isHaveFK) {\r\n\r\n                //这里做是否可以放的判断\r\n\r\n\r\n                for (var j = 1; j < children.length; j++) {\r\n                    var len = 27 //碰撞距离\r\n                    var childPos = cc.pAdd(srcPos, cc.p(children[j].x, children[j].y))\r\n\r\n                    //碰撞检测\r\n                    for (var k = 0; k < this.checkerboard.frameList.length; k++) {\r\n                        var tFrameNode = this.checkerboard.frameList[k]\r\n                        var dis = cc.pDistance(cc.p(tFrameNode.x, tFrameNode.y), childPos)\r\n                        if (dis <= len && !tFrameNode.isHaveFK) {\r\n                            count++ //可以放就要累加计数\r\n                        }\r\n                    }\r\n\r\n                }\r\n                //cc.log(\"格子\"+ frameNode.FKIndex +\"判断是否能放：\",children.length, count)\r\n\r\n                //如果数量相等就说明这个方块在这个格子是可以放下的\r\n                if (count == children.length) {\r\n                    //cc.log(frameNode.FKIndex + \"的位置可以放\", children.length, count)\r\n                    canDropCount++\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n\r\n        if (canDropCount == 0) {\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    },\r\n\r\n    //检测是否能够放下\r\n    checkIsCanDrop: function() {\r\n        //先判断数量是否一致，不一致说明有一个超出去了\r\n        if (this.checkFrameList.length == 0 || this.checkFrameList.length != this.node.children[0].children.length) {\r\n            return false\r\n        }\r\n\r\n\r\n        //检测放下的格子是否已经有方块\r\n        for (var i = 0; i < this.checkFrameList.length; i++) {\r\n            if (this.checkFrameList[i].isHaveFK) {\r\n                return false\r\n            }\r\n        }\r\n\r\n        return true\r\n    },\r\n\r\n    //放下逻辑\r\n    dropDownFunc: function() {\r\n        //Util.testCode1('放下逻辑')\r\n\r\n        if (!this.checkIsCanDrop()) {\r\n            //放回去\r\n            this.takeBack()\r\n\r\n            cc.audioEngine.playEffect(this.canNotSound1)\r\n            return\r\n        }\r\n\r\n        for (var i = 0; i < this.checkFKlist.length; i++) {\r\n            this.checkFKlist[i].x = 0\r\n            this.checkFKlist[i].y = 0\r\n\r\n\r\n            this.checkFKlist[i].parent = this.checkFrameList[i]\r\n            this.checkFrameList[i].isHaveFK = true\r\n\r\n            //cc.log(\"this.checkFrameList[\"+i+\"]:\", this.checkFrameList[i])\r\n\r\n            //特效\r\n            // var picNode = new cc.Node(\"guangEffNode\")\r\n            // var spr = picNode.addComponent(cc.Sprite)\r\n            // spr.spriteFrame = this.checkerboard[\"bian\"]\r\n            // this.checkFrameList[i].addChild(picNode, -1)\r\n            // var action = cc.repeatForever(cc.sequence(\r\n            //     cc.spawn(cc.fadeOut(1), cc.scaleTo(1, 1.2)),\r\n            //     cc.removeSelf()\r\n            // ))\r\n            // picNode.runAction(action)\r\n\r\n        }\r\n\r\n        this.node.removeAllChildren()\r\n        var oneNode = this.newOneNode()\r\n        this.node.addChild(oneNode)\r\n\r\n        this.checkerboard.curFKLen = this.checkFKlist.length\r\n        this.checkerboard.node.emit('succDropDownOne')\r\n\r\n        var ranC = Util.random(1, 3)\r\n        cc.audioEngine.playEffect(this[\"fangxiaSound\" + ranC])\r\n\r\n\r\n        //放回去\r\n        this.takeBack()\r\n\r\n        //直接用棋盘检测是不是输了\r\n        this.checkerboard.checkIsLose()\r\n\r\n        //Util.testCode2()\r\n    },\r\n\r\n    //回到原位\r\n    takeBack: function() {\r\n        //变色处理\r\n        this.checkFrameList = [] //清空数组\r\n        this.changeColorDeal()\r\n\r\n        this.node.getChildByName(\"kuai\").setScale(scaleParam)\r\n\r\n        this.node.x = this.node.ox\r\n        this.node.y = this.node.oy\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function() {\r\n        this.checkFrameList = []\r\n        this.checkFKlist = []\r\n\r\n        this.node.cascadeOpacity = true\r\n\r\n        var oneNode = this.newOneNode()\r\n        this.node.addChild(oneNode)\r\n\r\n        //添加触摸\r\n        this.addTouchEvent()\r\n\r\n        //debug字用\r\n        // var labelNode = new cc.Node(\"New Label\")\r\n        // var labelCp = this.node.addComponent(cc.Label)\r\n        // labelCp.string = \"x:\"+Math.floor(this.node.x) + \"\\ny:\" + Math.floor(this.node.y)\r\n        // labelCp.fontSize = 18\r\n        // labelNode.parent = this.node\r\n        // labelNode.zIndex = 1\r\n        // cc.log(\"Node zIndex: \" + labelNode.zIndex)\r\n        // this.debugLabel = labelCp\r\n    }\r\n\r\n\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});"]}